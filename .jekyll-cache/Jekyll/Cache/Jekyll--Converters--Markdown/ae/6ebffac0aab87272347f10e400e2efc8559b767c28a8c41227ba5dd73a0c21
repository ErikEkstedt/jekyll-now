I"Â$<p>Goal: Predict the future voice activation from diadic dialogues.</p>

<h2 id="from-simplest-towards-complex">From Simplest Towards Complex</h2>

<p>How should we think about the problem? What input should we use and why?</p>

<!--more-->

<h2 id="starting-point">Starting Point</h2>

<p>Based on the fact that out output space consists of binary values for voice activation the
simplest model would use the same space as input space.</p>

<h2 id="non-discrete-feature-intensity">Non Discrete Feature, Intensity</h2>

<p>Instead of actually training on the VAD (requires some preprocessing step which
could be better or worse) we instead train on the next best thing.  The voice
activity will most probably be defined by taking into account intensity, the
amount of energy or power, in each audio frame. Lets see how well the model does
on only the intensity as intput.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Inputs</strong></th>
      <th style="text-align: left"><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Intensity</td>
      <td style="text-align: left">Well defined everywhere. bounded [0, normalized_max(power, energy) ].  Continuous</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Outputs</strong></td>
      <td style="text-align: left"><strong>Description</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Binary Voice activity (VAD)</td>
      <td style="text-align: left">Well defined everywhere. Bounded [0, 1]. Discontinuous</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Model
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window FC</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window Conv</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />frame RNN</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />window RNN</li>
    </ul>
  </li>
</ul>

<p>Training</p>
<ul>
  <li>Do we converge?</li>
  <li>How does the predictions look?</li>
</ul>

<h2 id="adding-prosody">Adding Prosody</h2>

<p>Lets use the model from the previous section but now we add some prosodic information we
guess should be useful. We extract the intensity for each frame along with the pitch. The
intensity is straight forward to implement and is defined everywhere, it is a continuous
number between 0-no intensity and max, the maximum intensity possible (bounded by the
maximum energy of the microphone etc. maximum intensity of the audio signal). The maximum
could be normalized speaker wise or across the dataset. The pitch, however, is another
story. The basis for the pitch is the fundamental frequency, the first harmonic, of voiced
speech. Usually in the region 85-180Hz for males and 165 - 255Hz for females but it is
only present during voiced regions of the signal. A frequency $ \frac{1}{n} != 0 $</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Inputs</strong></th>
      <th style="text-align: left"><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Intensity</td>
      <td style="text-align: left">Well defined everywhere. bounded [0, normalized_max(power, energy)].  Continuous</td>
    </tr>
    <tr>
      <td style="text-align: left">Pitch (F0)</td>
      <td style="text-align: left">Semitones. Well defined on voiced segment. Not defined at unvoiced. Z-normalized to disentangle speaker info</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Outputs</strong></td>
      <td style="text-align: left"><strong>Description</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Binary Voice activity (VAD)</td>
      <td style="text-align: left">Well defined everywhere. Bounded [0, 1]. Discontinuous</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Model
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window FC</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window Conv</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />frame RNN</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />window RNN</li>
    </ul>
  </li>
  <li>Normalize/no-normalization of pitch
    <ul>
      <li>Effects convergence?</li>
    </ul>
  </li>
  <li>Did adding the intensity and pitch improve the model</li>
</ul>

<h2 id="adding-mfcc-first-four">Adding MFCC (first four)</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Inputs</strong></th>
      <th style="text-align: left"><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Intensity</td>
      <td style="text-align: left">Well defined everywhere. bounded [0, normalized_max(power, energy)].  Continuous</td>
    </tr>
    <tr>
      <td style="text-align: left">Pitch (F0)</td>
      <td style="text-align: left">Semitones. Well defined on voiced segment. Not defined at unvoiced. Z-normalized to disentangle speaker info</td>
    </tr>
    <tr>
      <td style="text-align: left">MFCC (0-3)</td>
      <td style="text-align: left">Defined everywhere. Different magnitudes for the different coefficients</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Outputs</strong></td>
      <td style="text-align: left"><strong>Description</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Binary Voice activity (VAD)</td>
      <td style="text-align: left">Well defined everywhere. Bounded [0, 1]. Discontinuous</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Model
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window FC</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Window Conv</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />frame RNN</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />window RNN</li>
    </ul>
  </li>
</ul>

<h2 id="results">Results</h2>

<p>The results from training these 3 types of network showed something interesting. The
losses seems to be very similar but the scoring metric is different! All models converges
towards the same loss for both training and validation set (underfitting?) but although
intensity and intensity+pitch does about the same the added MFCC feature does much better
on the validation metric.</p>

<h3 id="loss">Loss</h3>

<p>The loss is very similar for all three models. They converge in about the same time and
reached the same loss (validation and training).</p>

<p><img src="/images/turntaking/tt_training/loss_small.png" alt="training loss" /></p>

<h3 id="fscore-on-shift-and-hold-events">Fscore on shift and hold events</h3>

<p>The fscore metric shows that although the losses are similar the performance on the metric
is not. The model with the added MFCC feature doessignificantly better than the other
iterations.</p>

<p><img src="/images/turntaking/tt_training/fscore_small_05_1.png" alt="training fscore 50, 100ms" />
<img src="/images/turntaking/tt_training/fscore_small_2_5.png" alt="training fscore 200, 500ms" /></p>

<h2 id="prosody-information-important-when-using-mfcc-features">Prosody Information important when using MFCC features?</h2>

<p>One straightforward follow up question is now whether the prosody information (pitch and
intensity) does anything valuable when using the MFCC features. Lets investigate that by
only training on the MFCC features.</p>

<p>For the training with only MFCC features the losses were again pretty much
exactly the same but as with the pitch, intensity, mfcc model it score better
than only the intensity and pitch model.</p>

<p><img src="/images/turntaking/tt_training/fscore_small_all_05_1.png" alt="" width="100%" />
<img src="/images/turntaking/tt_training/fscore_small_all_2_5.png" alt="" width="100%" /></p>

<h3 id="melspectrogram-looking-at-the-complete-spectrum">MelSpectrogram, Looking at the complete spectrum</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Inputs</strong></th>
      <th style="text-align: left"><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">MelSpectrogram</td>
      <td style="text-align: left">Well defined everywhere. Continuous. Using Frequency z normalization over each speaker</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Outputs</strong></td>
      <td style="text-align: left"><strong>Description</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Binary Voice activity (VAD)</td>
      <td style="text-align: left">Well defined everywhere. Bounded [0, 1]. Discontinuous</td>
    </tr>
  </tbody>
</table>

:ET